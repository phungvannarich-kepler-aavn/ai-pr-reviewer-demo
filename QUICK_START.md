# Quick Start Guide: Using GitHub PR Comment Feature

## Prerequisites

1. **Get a GitHub Personal Access Token**
   - Go to: https://github.com/settings/tokens
   - Click "Generate new token" ‚Üí "Generate new token (classic)"
   - Give it a name like "AI PR Reviewer"
   - Select scopes:
     - ‚úÖ `repo` (for full access to private and public repos)
     - OR ‚úÖ `public_repo` (if you only review public repos)
   - Click "Generate token"
   - **Copy the token immediately** (you won't see it again!)

2. **Configure Environment Variables**
   ```bash
   # Copy the example file
   cp .env.example .env
   
   # Edit .env and add your tokens
   OPENROUTER_API_KEY=sk-or-v1-your-key-here
   GITHUB_TOKEN=ghp_your_github_token_here
   LLM_MODEL=anthropic/claude-3-haiku
   ```

## Running the Application

### Using Docker Compose (Recommended)

```bash
# From project root
docker-compose up --build
```

Then open http://localhost:8501

### Using Python Directly

**Terminal 1 - Backend:**
```bash
cd backend
pip install -r requirements.txt
uvicorn main:app --reload
```

**Terminal 2 - Frontend:**
```bash
cd frontend
pip install -r requirements.txt
streamlit run app.py
```

## Using the GitHub Comment Feature

### Option 1: Via Web UI

1. Open http://localhost:8501
2. Check the sidebar to verify:
   - ‚úÖ GitHub Token configured
   - ‚úÖ OpenRouter API configured
3. Paste a GitHub PR URL (e.g., `https://github.com/facebook/react/pull/28457`)
4. **Check the box**: ‚òëÔ∏è "Post review as comment directly to GitHub PR"
5. Click "üöÄ Run Review"
6. Wait for the analysis (30-60 seconds)
7. See results:
   - ‚úÖ Success message with link to GitHub comment
   - Review displayed in the web UI
   - Click the GitHub link to see the comment on the PR

### Option 2: Via API (cURL)

```bash
# Review and post to GitHub
curl -X POST http://localhost:8000/review \
  -H "Content-Type: application/json" \
  -d '{
    "pr_url": "https://github.com/owner/repo/pull/123",
    "post_to_github": true
  }'
```

### Option 3: Via Python

```python
import requests

response = requests.post(
    "http://localhost:8000/review",
    json={
        "pr_url": "https://github.com/owner/repo/pull/123",
        "post_to_github": True
    }
)

result = response.json()
if result["github_comment_posted"]:
    print(f"Comment posted: {result['github_comment_url']}")
```

## What Gets Posted to GitHub

The AI review is formatted as a beautiful markdown comment:

```markdown
# ü§ñ AI Code Review

## ‚úÖ **APPROVED**

## üìù Summary
This PR adds a new authentication module with proper error handling...

## üí¨ Detailed Comments

### 1. `src/auth.py` (Line 42)
**üîç Issue:** Hardcoded secret key detected
**üí° Suggestion:** Use environment variable for SECRET_KEY

### 2. `src/utils.py` (Line 15)
**üîç Issue:** Missing error handling for database connection
**üí° Suggestion:** Add try-catch block to handle connection failures

---
*This review was generated by AI PR Reviewer*
```

## Troubleshooting

### "Review generated but could not be posted to GitHub"

**Causes:**
- GitHub token not configured or invalid
- Token doesn't have write permissions
- Repository requires specific permissions

**Solutions:**
1. Verify `GITHUB_TOKEN` is set in `.env`
2. Check token has `repo` or `public_repo` scope
3. Ensure you have write access to the repository
4. Try with your own test repository first

### "API Disconnected"

**Solution:** Start the backend server:
```bash
cd backend
uvicorn main:app --reload
```

### "Authentication failed"

**Solution:** Verify your OpenRouter API key is correct:
```bash
# Test the API key
curl https://openrouter.ai/api/v1/models \
  -H "Authorization: Bearer $OPENROUTER_API_KEY"
```

## Testing with Your Own Repository

1. Create a test repository on GitHub
2. Make a branch with some code
3. Open a Pull Request
4. Use the AI PR Reviewer to review it
5. Check the PR comments tab to see the AI review

## Example Workflow

```bash
# 1. Setup
cp .env.example .env
# Edit .env with your tokens

# 2. Start services
docker-compose up --build

# 3. Open browser
# ‚Üí http://localhost:8501

# 4. Review a PR
# ‚Üí Paste: https://github.com/your-username/your-repo/pull/1
# ‚Üí Check: "Post review as comment to GitHub PR"
# ‚Üí Click: "üöÄ Run Review"

# 5. See results
# ‚Üí Review in UI
# ‚Üí Comment on GitHub
# ‚Üí Share with team!
```

## Pro Tips

1. **Test First**: Try on your own repository before using on team repos
2. **Rate Limits**: GitHub has rate limits (5000 requests/hour with token)
3. **Cost**: OpenRouter charges per token, monitor your usage
4. **Privacy**: The PR diff is sent to OpenRouter's LLM
5. **Bot Identification**: Comments clearly show they're AI-generated

## Next Steps

- Try different LLM models for comparison
- Review multiple PRs from the same repository
- Share the tool with your team
- Customize the review prompt for your needs
- Add CI/CD integration for automatic reviews

Enjoy automated code reviews! üöÄ
